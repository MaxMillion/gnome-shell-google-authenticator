Based on the JavaScript implementation as provided by Tin Isles: http://blog.tinisles.com/2011/10/google-authenticator-one-time-password-algorithm-in-javascript/
